name: main
on:
  push:
    branches: [ main ]
  workflow_dispatch:
env:
  GPR_USER: ${{ secrets.GPR_USER }}
  GPR_KEY: ${{ secrets.GPR_KEY }}
jobs:
  test:
    name: test
    permissions:
      packages: read
    uses: ./.github/workflows/step-test.yaml
  release:
    needs: test
    name: release
    permissions:
      packages: write
      contents: write
    uses: ./.github/workflows/step-release.yaml
  merge:
    needs: release
    name: merge
    permissions:
      contents: write
    uses: ./.github/workflows/step-merge.yaml
